---
title: Elasticsearch 入门，基础概念
categories:
  - 翻译
  - Elasticsearch
tags:
  - Elasticsearch
  - 翻译
date: 2018-03-07 15:38:48
---


### 基础概念

这里有几个概念是 Elasticsearch 的核心。 从一开始就理解这些概念在很大程度上有助于缓解学习过程难度。


#### 准实时 (Near Realtime, NRT)

Elasticsearch 是一个准实时搜索平台。这意味着你从索引一个文档到它可被搜索到只有轻微的时间延迟（通常为1秒）。


#### 集群 (Cluster)

集群是一个或多个节点（服务器）的集合，他们共同保存你的整个数据，并提供跨所有节点的联合索引和搜索功能。集群由唯一的名称标识，默认情况下是“elasticsearch”。这个名字很重要，因为如果一个节点如果被设置为加入集群，那么他只能通过其名称加入一个集群并成为集群的一部分，

确保不要做不同的环境中使用相同的集群名称，否则可能会导致节点加入错误的集群。例如，您可以对开发，分段和生产集群分别使用`logging-dev`，`logging-stage`和`logging-prod` 作为集群名称。

请注意，拥有只有一个节点的集群是可行和能正常运行的。此外，你也可以拥有多个独立的群集，每个群集都有自己独特的群集名称。


#### 节点 (Node)
节点是作为集群一部分的单一服务器，存储数据，并参与集群的索引和搜索功能。就像一个集群一样，一个节点被一个名称标识，默认情况下是一个随机的通用唯一标识符（UUID），它在启动时分配给节点。如果您不想要默认值，您可以定义所需的任何节点名称。此名称对于管理目的很重要，您希望确定网络中哪些服务器对应于Elasticsearch集群中的哪些节点。

可以将节点配置为按集群名称加入特定集群。默认情况下，每个节点都设置为加入名为的集群elasticsearch，这意味着如果您启动了网络上的多个节点，并且假设它们可以互相发现，则它们将自动形成并加入名为的单个集群elasticsearch。

在单个集群中，您可以拥有所需的节点数。此外，如果您的网络上当前没有其他Elasticsearch节点运行，启动单个节点将默认形成一个名为的新的单节点集群elasticsearch。

#### 索引 (Index)
索引就是具有某些相似特征的文档的一个集合。例如，你可以有一个客户数据索引，另外一个产品目录的索引，以及一个订单数据的索引。一个索引有名称（必须全部为小写字母）标志，这个名字用在对其中的文档进行索引，搜索，更新和删除操作是进行定位索引。

在单个集群里，你可以根据需要定义任意多个索引。


#### 类型 (Type)

在索引中，您可以定义一个或多个类型。类型是你的索引的逻辑分类/分区，其语义完全取决于你。 通常，为具有一组公共字段的文档定义了一种类型。 例如，假设您运行一个博客平台，并将所有数据存储在单个索引中。 在此索引中，您可以定义用户数据类型，博客数据类型以及注释数据类型。


#### 文档 (Document)

文档是可以被索引的基本信息单元。例如，您可以拥有一个客户的文档，一个产品的文档，一个订单的文档。 这个文档以 JSON（JavaScript Object Notation）表示，这是一种应用广泛的互联网数据交换格式。

在索引/类型中，您可以存储你想要存储的任意数量的文档。 请注意，虽然文档物理上位于索引中，但实际上文档实际上必须被索引/分配到索引中的某个类型。


#### 分片和复制 (Shards & Replicas)
索引可能潜在地存储大量数据，这些数据可能会超出单个节点的硬件限制。 例如，占用 1TB 磁盘空间的十亿份文档的单个索引可能不适合单个节点的磁盘，或者可能太慢而无法单独向单个节点提供搜索请求。

为了解决这个问题，Elasticsearch提供了将索引细分为多个碎片的功能。 当您创建索引时，您可以简单地定义所需的碎片数量。 每个分片本身都是一个功能齐全且独立的“索引”，可以在集群中的任何节点上进行托管。

分片的重要性主要有两个原因：
* 它允许您水平分割/缩放您的内容量
* 它允许您跨越分片（可能在多个节点上）分发和并行操作，从而提高性能/吞吐量

分片如何分布的机制以及其文档如何聚合回搜索请求完全由Elasticsearch管理，并且作为用户对您透明。

在任何时候都可能出现故障的网络/云环境中，非常有用并且强烈建议有一个故障切换机制，以防碎片/节点以某种方式脱机或因任何原因而消失。 为此，Elasticsearch允许您将索引碎片的一个或多个副本制作为简称为副本碎片或副本。

复制很重要主要有两个原因：

* 它在碎片/节点失败的情况下提供高可用性。 由于这个原因，需要注意的是，副本分片永远不会分配到与从中复制的原始/主分片相同的节点上。
* 它允许您扩展搜索量/吞吐量，因为搜索可以在所有副本上并行执行。

总而言之，每个索引可以分成多个分片。 索引也可以被复制为零（意味着没有副本）或更多次。 一旦复制，每个索引将具有主分片（从中复制的原始分片）和副本分片（主分片的副本）。 在创建索引时，可以为每个索引定义分片和副本的数量。 在创建索引之后，您可以随时更改动态副本的数量，但您无法在事后更改碎片的数量。

默认情况下，Elasticsearch中的每个索引都分配了5个主分片和1个副本，这意味着如果您的集群中至少有两个节点，则索引将包含5个主分片和另外5个副本分片（1个完整副本），总共 每个索引10个碎片。

#### 注意
Elasticsearch 的每一个分片都是一个 Lucene 索引。 你在单个 Lucene 索引里所拥有的文档有最大数量值限制。在 [LUCENE-5843](https://issues.apache.org/jira/browse/LUCENE-5843) 里，这个极限值是 `2,147,483,519` (= `Integer.MAX_VALUE - 128`)。你可以使用 [_cat/shards](https://www.elastic.co/guide/en/elasticsearch/reference/6.2/cat-shards.html) API 来监控分片容量。

在了解这些基础概念后，我们可以进入有趣的部分了。。
